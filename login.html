<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">



        <!-- Bootstrap CSS/JS e JQuery -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <!--
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
        -->
        <meta name="google-signin-client_id" content="296707453684-69nvprqosvpf2nr3tmt1sqnjkp7ienic.apps.googleusercontent.com">

        <!--
        <meta name="google-signin-client_id" content="YOUR_CLIENT_ID.apps.googleusercontent.com">
        -->
        <link rel="stylesheet" href="css/padrao.css">
        <link rel="stylesheet" href="css/login.css">
        <script src="js/padrao.js"></script>
        <script src="js/login.js"></script>
        <!--
        <script src="js/google-user.js"></script>
        -->

        <!-- <script src="https://apis.google.com/js/platform.js" async defer></script> 
        <script src="https://apis.google.com/js/platform.js?onload=renderButton" async defer></script>
-->

    </head>
    <body>

        <!-- ===============================================================================
                                             CABEÇALHO
        ================================================================================ -->
        <!--
        <nav class="navbar navbar-default navbar-fnt navbar-backgrnd navbar-fixed-top">
        -->
            <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" id="setaRetorno" href="#">
                        <span class="glyphicon glyphicon-menu-left"></span>
                    </a>
                    <div class="navbar-brand" id="tituloLogin">Login</div>
                </div>
            </div>
        </nav>

        <!-- ===============================================================================
                                         CORPO DA PAGINA
        =============================================================================== -->
 
        <!--
        <div class="container" id="corpoPagina">
            <div class="box-login text-center">
                <h5><strong>LOGIN UTILIZANDO CONTA GOOGLE</strong></h5>
                <br>
                <div id="my-signin2"></div>
                <br><br>
                <button type="button" class="btn btn-danger btn-lg btn-block" id="btn-logout">Logout</button>
                <a class="btn btn-success btn-lg btn-block" id="btn-voltar" href="#">Voltar</a>
            </div>
        </div>
        -->

        <div class="container" id="corpoPagina">

            <div id="loader" class="loader center-block"></div>

            <div id="paginaLogin" class="invisible">
                <div class="box-login text-center">
                    <h5><strong>FAÇA LOGIN UTILIZANDO SUA CONTA GOOGLE</strong></h5>
                    <br>
                    <div id="my-signin2"></div>
                    <br><br>
                    <a class="btn btn-success btn-lg btn-block btn-voltar" href="#">Voltar</a>
                </div>           
            </div>

            <div id="paginaLogado" class="invisible">
                <div class="box-login text-center">
                <h5><strong>VOCÊ ESTÁ LOGADO COM SUA CONTA GOOGLE</strong></h5>
                <br>
                <div class="row">
                <div class="column">
                    <div class="card">
                    <img src="#" class="img-responsive img-circle center-block" id="userImageURL">
                    <div class="container">
                        <h2 id="userName"></h2>
                        <h4 id="userEmail"></h4>
                        <p><button class="btn btn-primary" id="btn-logout">Fazer Logout</button></p>
                    </div>
                    </div>
                </div>
                </div>
                <br><br>
                <!--
                <button type="button" class="btn btn-danger btn-lg btn-block" id="btn-logout">Logout</button>
                -->
                <a class="btn btn-success btn-lg btn-block btn-voltar" href="#">Voltar</a>
                </div>
            </div>

        </div>

        <!-- ===============================================================================
                                            RODAPE
        =============================================================================== -->

        <nav class="navbar navbar-default navbar-fixed-bottom">
            <div class="container-fluid">
                <div class="navbar-header">
                    <div class="navbar-brand">ByteDoBem</div>
                </div>
            </div>
        </nav>

        <!-- Botao de Login do Google -->
        <script>
            function renderButton() {

                console.log("login.html> executando o renderButton...");

                var auth2; // The Sign-In object.
                var googleUser; // The current user.

                /**
                 * Calls startAuth after Sign in V2 finishes setting up.
                 */
                var appStart = function() {
                    gapi.load('auth2', initSigninV2);
                };
                // appStart();
                console.log("login.html> auth2.. " + auth2);

                /**
                 * Initializes Signin v2 and sets up listeners.
                 */
                var initSigninV2 = function() {
                    console.log("login.html> estah no initSigninV2");
                    auth2 = gapi.auth2.init({
                        client_id: '296707453684-69nvprqosvpf2nr3tmt1sqnjkp7ienic.apps.googleusercontent.com',
                        scope: 'profile'
                    });

                    // Listen for sign-in state changes.
                    auth2.isSignedIn.listen(signinChanged);

                    // Listen for changes to current user.
                    auth2.currentUser.listen(userChanged);

                    // Sign in the user if they are currently signed in.
                    if (auth2.isSignedIn.get() == true) {
                        auth2.signIn();
                    }

                    // Start with the current live values.
                    refreshValues();
                };

                /**
                 * Listener method for sign-out live value.
                 *
                 * @param {boolean} val the updated signed out state.
                 */
                var signinChanged = function (val) {
                    console.log('Signin state changed to ', val);
                    document.getElementById('signed-in-cell').innerText = val;
                };

                /**
                 * Listener method for when the user changes.
                 *
                 * @param {GoogleUser} user the updated user.
                 */
                var userChanged = function (user) {
                    console.log('User now: ', user);
                    googleUser = user;
                    updateGoogleUser();
                    document.getElementById('curr-user-cell').innerText =
                        JSON.stringify(user, undefined, 2);
                };

                /**
                 * Updates the properties in the Google User table using the current user.
                 */
                var updateGoogleUser = function () {
                    if (googleUser) {
                        document.getElementById('user-id').innerText = googleUser.getId();
                        document.getElementById('user-scopes').innerText =
                        googleUser.getGrantedScopes();
                        document.getElementById('auth-response').innerText =
                        JSON.stringify(googleUser.getAuthResponse(), undefined, 2);
                    } else {
                        document.getElementById('user-id').innerText = '--';
                        document.getElementById('user-scopes').innerText = '--';
                        document.getElementById('auth-response').innerText = '--';
                    }
                };

                /**
                 * Retrieves the current user and signed in states from the GoogleAuth
                 * object.
                 */
                var refreshValues = function() {
                    if (auth2){
                        console.log('Refreshing values...');

                        googleUser = auth2.currentUser.get();

                        document.getElementById('curr-user-cell').innerText =
                        JSON.stringify(googleUser, undefined, 2);
                        document.getElementById('signed-in-cell').innerText =
                        auth2.isSignedIn.get();

                        updateGoogleUser();
                    }
                }



                console.log("login.html> antes do gapi.render...");
                gapi.signin2.render('my-signin2', {
                    'scope': 'profile email',
                    'width': 300,
                    'height': 50,
                    'longtitle': true,
                    'theme': 'dark',
                    'onsuccess': onSignIn,
                    'onfailure': onFailure
                });


            }
        </script>
        <script src="js/google-user.js"></script>
        <script src="https://apis.google.com/js/platform.js?onload=renderButton" async defer></script>
        <!--
        <script src="https://apis.google.com/js/plus.js?onload=init"></script>
        <script src="https://apis.google.com/js/api.js?onload=start" async defer></script>
        <script src="js/google-user.js"></script>
        -->
    </body>
</html>
